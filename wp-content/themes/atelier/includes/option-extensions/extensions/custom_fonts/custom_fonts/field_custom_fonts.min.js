
(function(c){redux=redux||{};redux.field_objects=redux.field_objects||{};redux.field_objects.custom_fonts=redux.field_objects.custom_fonts||{};var a;var b=false;redux.field_objects.custom_fonts.init=function(d){if(!d){d=c(document).find(".redux-group-tab:visible").find(".redux-container-custom_font:visible")}c(d).each(function(){var f=c(this);var e=f;if(!f.hasClass("redux-field-container")){e=f.parents(".redux-field-container:first")}if(e.is(":hidden")){return}if(e.hasClass("redux-field-init")){e.removeClass("redux-field-init")}else{return}redux.field_objects.custom_fonts.modInit(f)})};redux.field_objects.custom_fonts.modInit=function(d){a=redux_custom_fonts_l10;d.find(".remove-font").unbind("click").on("click",function(){redux.field_objects.custom_fonts.remove_font(d,c(this).parents("fieldset.redux-field:first"))});d.find(".media_add_font").unbind().on("click",function(e){redux.field_objects.custom_fonts.add_font(d,e,c(this).parents("fieldset.redux-field:first"))});d.find(".fontDelete").on("click",function(h){h.preventDefault();var f=c(this).parents("td:first");f.find(".spinner").show();var g=c(this).data();g.action="redux_custom_fonts";g.nonce=c(this).parents(".redux-container-custom_font:first").find(".media_add_font").attr("data-nonce");c.post(ajaxurl,g,function(i){i=c.parseJSON(i);if(i.type&&i.type=="success"){var e=f.parents("table:first").find("tr").length;if(e==1){f.parents("table:first").fadeOut().remove()}else{f.parents("tr:first").fadeOut().remove()}}else{alert(a.delete_error+" "+i.msg);f.find(".spinner").hide()}});return false})};redux.field_objects.custom_fonts.startTimer=function(f,e){var d;c.ajax({url:ajaxurl,type:"POST",data:{action:"redux_custom_font_timer"},beforeSend:function(){},success:function(g){var h;if(b==false){setTimeout(redux.field_objects.custom_fonts.startTimer(f,e),500);h=redux.args.please_wait+": "+e+"<br><br>"+g}else{h=a.complete;g="finished"}if(g!=""){if(g!=d){c(".blockUI.blockMsg h2").html(h);d=g}}}})};redux.field_objects.custom_fonts.add_font=function(e,f,d){f.preventDefault();var g;if(g){g.open();return}g=wp.media({multiple:false,library:{type:["application","font"]},title:"Redux Custom Fonts:  "+a.media_title,button:{text:a.media_button}});g.on("click",function(){});g.on("select",function(){var l=g.state().get("selection").first();var i=d.find(".font-error");i.slideUp();i.find("span").text("");g.close();if(l.attributes.type!=="application"&&l.attributes.type!=="font"){return}var j=c(d).find(".media_add_font").attr("data-nonce");var k={action:"redux_custom_fonts",nonce:j,attachment_id:l.id,title:l.attributes.title,mime:l.attributes.mime};if(k.mime=="application/zip "){var h=a.unzip}else{var h=a.convert}redux.field_objects.custom_fonts.startTimer(e,h);c.blockUI({message:"<h2>"+redux.args.please_wait+": "+h+"</h2>"});c.post(ajaxurl,k,function(m){console.log("Redux Custom Fonts API Response (For support purposes)");console.log(m);m=c.parseJSON(m);if(m.type=="success"){if(m.msg!=""){c.unblockUI();i.find("span").text(m.msg+"  "+a.partial);i.slideDown();b=true;return}window.onbeforeunload="";location.reload()}else{if(m.type=="error"){c.unblockUI();i.find("span").text(m.msg);i.slideDown()}else{c.unblockUI();i.find("span").text(a.unknown);i.slideDown()}}b=true})});g.open()};redux.field_objects.custom_fonts.remove_font=function(e,d){if(!d.find(".remove-image").addClass("hide")){return}};redux.field_objects.custom_fonts.sleep=function(d){var f=new Date().getTime();for(var e=0;e<10000000;e++){if((new Date().getTime()-f)>d){break}}}})(jQuery);